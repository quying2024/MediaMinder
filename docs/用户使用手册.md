# MediaMinder 用户使用手册

## 欢迎使用MediaMinder

MediaMinder是一个智能相机照片管理工具，能够自动检测USB相机插入，下载照片到本地，并提供直观的照片展示界面。本手册将指导您如何使用MediaMinder的各项功能。

## 快速开始

### 1. 启动MediaMinder

#### 1.1 启动方式
- **自动启动**: 如果已配置开机自启，MediaMinder会在系统启动时自动运行
- **手动启动**: 双击桌面上的MediaMinder图标，或从开始菜单启动
- **服务状态**: MediaMinder服务会在后台自动运行

#### 1.2 首次启动
1. 启动MediaMinder UI应用
2. 系统会自动连接到后台服务
3. 界面显示"已连接"状态表示服务正常运行

### 2. 连接相机

#### 2.1 支持的相机
MediaMinder支持以下品牌的相机：
- **Canon**: G16, EOS, PowerShot, Digital系列
- **Nikon**: D系列, Z系列, COOLPIX系列
- **Sony**: DSC, α系列, ILCE系列
- **其他品牌**: FUJIFILM, Panasonic, Olympus, Leica, Pentax, Ricoh等

#### 2.2 连接步骤
1. 将相机通过USB线连接到电脑
2. 打开相机电源
3. 等待系统自动识别相机
4. 查看MediaMinder界面状态变化

## 主要功能

### 1. 自动照片下载

#### 1.1 下载过程
当MediaMinder检测到支持的相机时，会自动：
1. 识别相机品牌和型号
2. 扫描DCIM目录结构
3. 选择最新生成的子目录
4. 下载其中的所有照片
5. 验证下载完整性
6. 删除相机中的源文件（可选）

#### 1.2 下载状态
- **检测中**: 正在识别相机
- **下载中**: 正在下载照片
- **验证中**: 正在验证下载完整性
- **完成**: 下载完成

#### 1.3 下载设置
- **只下载最新目录**: 默认只下载最新生成的子目录
- **验证下载**: 自动验证下载文件的完整性
- **删除源文件**: 下载成功后删除相机中的源文件

### 2. 照片展示

#### 2.1 界面布局
- **自适应尺寸**: 窗口按屏幕80%尺寸打开
- **3列网格**: 照片以3列网格形式展示
- **无限滚动**: 支持显示任意数量照片，带滚动条
- **缩略图**: 200x200像素的缩略图显示

#### 2.2 照片操作
- **查看照片**: 点击照片查看详细信息
- **双击打开**: 双击照片使用Photoshop或默认程序打开
- **打开文件夹**: 点击"📁 打开照片文件夹"按钮

#### 2.3 实时更新
- **自动刷新**: 新照片下载后自动显示
- **状态更新**: 实时显示连接状态
- **消息通知**: 显示操作状态和结果

### 3. 备份和清理

#### 3.1 自动备份
当您关闭MediaMinder窗口时，系统会自动：
1. 释放所有图片资源
2. 创建时间戳命名的备份目录
3. 备份根目录中的所有照片
4. 验证备份完整性
5. 删除根目录中的照片
6. 清理过期的备份目录

#### 3.2 备份目录
- **命名格式**: `Backup_yyyyMMdd_HHmmss`
- **存储位置**: `C:\ProgramData\MediaMinder\Photos\`
- **保留时间**: 默认保留1周，过期自动清理

## 界面说明

### 1. 主界面

#### 1.1 标题栏
- **应用名称**: MediaMinder - 照片展示
- **连接状态**: 显示"已连接"或"未连接"
- **窗口控制**: 最小化、最大化、关闭按钮

#### 1.2 照片区域
- **照片网格**: 3列网格布局显示照片
- **滚动条**: 照片数量多时显示滚动条
- **加载状态**: 显示"加载中..."或"加载失败"

#### 1.3 底部按钮
- **📁 打开照片文件夹**: 打开照片存储目录

### 2. 状态指示

#### 2.1 连接状态
- **已连接**: 绿色状态，服务正常运行
- **未连接**: 红色状态，服务未运行或连接失败

#### 2.2 操作状态
- **等待照片**: 没有照片时的提示
- **加载中**: 正在加载照片
- **加载失败**: 照片加载失败

## 操作指南

### 1. 基本操作

#### 1.1 启动应用
1. 双击MediaMinder图标
2. 等待应用启动
3. 确认显示"已连接"状态

#### 1.2 连接相机
1. 将相机连接到电脑USB端口
2. 打开相机电源
3. 等待自动识别和下载

#### 1.3 查看照片
1. 在照片网格中浏览照片
2. 使用滚动条查看更多照片
3. 双击照片打开查看

#### 1.4 打开文件夹
1. 点击"📁 打开照片文件夹"按钮
2. 系统会打开照片存储目录
3. 可以手动管理照片文件

### 2. 高级操作

#### 2.1 照片管理
- **移动照片**: 在文件夹中移动照片到其他位置
- **删除照片**: 删除不需要的照片
- **重命名照片**: 重命名照片文件
- **创建文件夹**: 创建新的照片分类文件夹

#### 2.2 备份管理
- **查看备份**: 在照片目录中查看备份文件夹
- **恢复照片**: 从备份文件夹中恢复照片
- **清理备份**: 手动删除不需要的备份

#### 2.3 设置调整
- **配置文件**: 修改`appsettings.json`配置文件
- **相机品牌**: 添加新的相机品牌支持
- **下载设置**: 调整下载和验证选项

## 故障排除

### 1. 常见问题

#### 1.1 相机无法识别
**问题**: 连接相机后没有反应
**解决方案**:
1. 检查相机是否支持（查看支持的相机列表）
2. 确认相机已开机并处于传输模式
3. 尝试重新连接USB线
4. 检查USB端口是否正常工作
5. 重启MediaMinder应用

#### 1.2 照片下载失败
**问题**: 相机识别成功但照片下载失败
**解决方案**:
1. 检查相机存储卡是否有足够空间
2. 确认照片文件没有损坏
3. 检查目标目录是否有写入权限
4. 查看服务日志了解详细错误信息

#### 1.3 界面无法显示照片
**问题**: 照片已下载但界面不显示
**解决方案**:
1. 点击"📁 打开照片文件夹"检查文件是否存在
2. 重启MediaMinder UI应用
3. 检查照片文件格式是否支持
4. 确认照片文件没有损坏

#### 1.4 服务连接失败
**问题**: 界面显示"未连接"状态
**解决方案**:
1. 检查MediaMinder服务是否正在运行
2. 重启MediaMinder服务
3. 检查防火墙设置
4. 重新安装MediaMinder

### 2. 错误信息

#### 2.1 常见错误信息
- **"相机识别失败"**: 相机品牌不支持或识别条件不满足
- **"下载验证失败"**: 下载的文件与源文件不一致
- **"文件被占用"**: 照片文件被其他程序使用
- **"权限不足"**: 没有足够的文件访问权限

#### 2.2 错误处理
1. 查看错误信息的详细描述
2. 根据错误类型采取相应措施
3. 查看服务日志获取更多信息
4. 联系技术支持（如需要）

## 最佳实践

### 1. 使用建议

#### 1.1 相机使用
- **定期清理**: 定期清理相机存储卡
- **备份重要照片**: 重要照片及时备份到其他位置
- **检查连接**: 确保USB连接稳定
- **相机设置**: 将相机设置为传输模式

#### 1.2 照片管理
- **定期整理**: 定期整理照片文件夹
- **分类存储**: 按日期或主题分类存储照片
- **备份策略**: 建立定期备份策略
- **存储空间**: 监控存储空间使用情况

#### 1.3 系统维护
- **定期重启**: 定期重启MediaMinder服务
- **日志清理**: 定期清理日志文件
- **更新检查**: 定期检查软件更新
- **性能监控**: 监控系统性能

### 2. 性能优化

#### 2.1 系统优化
- **关闭不必要的程序**: 关闭其他占用资源的程序
- **增加内存**: 增加系统内存提高性能
- **使用SSD**: 使用SSD硬盘提高文件操作速度
- **定期清理**: 定期清理系统垃圾文件

#### 2.2 应用优化
- **合理设置**: 根据需求调整配置参数
- **批量操作**: 批量处理照片提高效率
- **异步操作**: 利用异步操作提高响应速度
- **缓存管理**: 合理管理缓存提高性能

## 技术支持

### 1. 获取帮助

#### 1.1 自助解决
1. 查看本用户手册
2. 检查常见问题解答
3. 查看系统日志
4. 尝试重启应用

#### 1.2 联系支持
- **技术支持邮箱**: support@mediaminder.com
- **用户论坛**: https://forum.mediaminder.com
- **在线文档**: https://docs.mediaminder.com
- **视频教程**: https://tutorial.mediaminder.com

### 2. 反馈建议

#### 2.1 问题反馈
- **错误报告**: 详细描述问题和重现步骤
- **性能问题**: 提供系统配置和性能数据
- **功能建议**: 提出新功能需求和建议
- **用户体验**: 反馈使用体验和改进建议

#### 2.2 贡献方式
- **测试反馈**: 参与新版本测试
- **文档改进**: 帮助改进用户文档
- **社区支持**: 帮助其他用户解决问题
- **功能开发**: 参与开源功能开发

## 更新日志

### 版本 1.0.0 (2024-12-20)
- **新功能**:
  - 支持34个相机品牌识别
  - 自动照片下载和验证
  - 智能备份和清理系统
  - 自适应照片展示界面
  - Photoshop优先打开功能
- **改进**:
  - 优化的连接稳定性
  - 改进的错误处理
  - 增强的日志记录
- **修复**:
  - 修复了文件句柄占用问题
  - 修复了UI响应问题
  - 修复了内存泄漏问题

## 许可证

MediaMinder采用MIT许可证，允许自由使用、修改和分发。

## 致谢

感谢所有为MediaMinder项目做出贡献的开发者和用户。

---

**MediaMinder团队**  
2024年12月20日
